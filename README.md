# 동시성

## 레이스 컨디션
> 둘 이상의 스레드가 공유 데이터에 액세스 할 수 있고 동시에 변경하려고 할 때 발생하는 문제

-> 하나의 스레드만 데이터에 액세스 할 수 있도록 함 

## Java synchronized 문제점
> 서버가 1대일 때는 되는 듯 싶지만, 여러 대의 서버를 사용하게 되면 사용하지 않았을 때와 동일한 문제 발생
- 인스턴스 단위로 thread-safe 보장이 되고, 서버가 여러개라는 것은 곧 여러 개의 인스턴스가 있다는 것과 동일하기 때문

## Pessimistic Locking
> 실제로 데이터에 Lock을 걸어 정합성을 맞춘다. Exclusive Lock을 걸게 되고, 다른 트랜잭션에서는 Lock이 해제되기전에 데이터를
> 가져갈 수 없다. 데드락이 발생할 수 있다
> Ex. SELECT FOR UPDATE 구문

## Optimistic Locking
> 실제로 Lock을 이용하지 않고, 버전을 이용함으로써 정합성을 맞춘다. 어플리케이션이 제공하는 락(JPA가 제공하는 버전 관리 기능 사용)
> 먼저 데이터를 읽은 후에 update 수행 시, 현재 내가 읽은 버전이 맞는지 확인하여 업데이트함
> 내가 읽은 버전에서 수정사항이 생긴 경우, application에서 다시 읽은 후에 작업 수행

## Named Lock
> 이름을 가진 metadata locking
> 이름을 가진 lock을 획득한 후 해제할 때 까지 다른 세션은 lock을 획득할 수 없다
> transaction이 종료될 때 자동으로 해제되지 않으므로 별도의 명령어를 통해 해제하거나 선점시간이 끝나야 해제됨